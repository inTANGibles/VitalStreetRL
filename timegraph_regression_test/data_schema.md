# 时间片数据集 Schema

## 概述

- **静态图**：101 节点，340 条无向边（edge_index 形状 [2, 680]）
- **时间片数量**：42
- **每个时间片**：同一张静态图 + 该时间片的节点标签 `y_t` 与监督 mask `mask_t`

## 42 个时间片的索引方式

索引 `t ∈ [0, 41]` 由 **day** 与 **hour** 唯一确定：

```
t = day_idx * 6 + hour_offset
```

其中：
- `day_idx ∈ {0, 1, 2, 3, 4, 5, 6}`：星期几（0=周一 … 6=周日，或按数据约定）
- `hour ∈ {12, 13, 14, 15, 16, 17}`：每天 12–18 点共 6 小时

| day_idx | hour_offset | hours        | t 范围    |
|---------|-------------|--------------|-----------|
| 0       | 0..5        | 12,13,14,15,16,17 | 0–5   |
| 1       | 0..5        | 12,13,14,15,16,17 | 6–11  |
| 2       | 0..5        | 12,13,14,15,16,17 | 12–17 |
| 3       | 0..5        | 12,13,14,15,16,17 | 18–23 |
| 4       | 0..5        | 12,13,14,15,16,17 | 24–29 |
| 5       | 0..5        | 12,13,14,15,16,17 | 30–35 |
| 6       | 0..5        | 12,13,14,15,16,17 | 36–41 |

**逆映射**：
- `day_idx = t // 6`
- `hour_offset = t % 6` → `hour = 12 + hour_offset`

## 每个 PyG Data 样本字段

| 字段        | 形状/类型      | 说明                                      |
|-------------|----------------|-------------------------------------------|
| `x_cont`    | [101, 11]      | 节点连续特征（标准化）                    |
| `func_type` | [101] long     | 功能类型，num_func_types=2                 |
| `time_feat` | [101, time_dim]| 时间特征，同一向量 repeat 到所有节点      |
| `edge_index`| [2, 680]       | 静态图边索引                              |
| `y`         | [101] float    | 该时间片的 log1p(flow) 标签               |
| `mask`      | [101] bool     | 该时间片有观测的节点为 True               |
| `meta`      | dict           | day_idx, hour                             |

## 时间特征 time_feat

- **time_dim = 4**（默认开启 day_of_week）：
  - `sin(hour/24 * 2π)`, `cos(hour/24 * 2π)`
  - `sin(day_of_week/7 * 2π)`, `cos(day_of_week/7 * 2π)`
- **time_dim = 2**（最小方案）：仅 hour 的 sin/cos

## 7-fold 划分

按 **day** 划分，避免时间泄露：
- 第 k 折：`test_day = k`，test 为 day k 的 6 个时间片；train 为其余 6 天的 36 个时间片
